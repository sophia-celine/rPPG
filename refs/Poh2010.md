# Non-contact, automated cardiac pulse measurements using video imaging and blind source separation

*Ming-Zher Poh, Daniel J. McDuff and Rosalind W. Picard*
Ming-Zher Poh, Daniel J. McDuff, and Rosalind W. Picard, "Non-contact, automated cardiac pulse measurements using video imaging and blind source separation.," Opt. Express 18, 10762-10774 (2010)

> the idea of performing physiological measurements on the face was first postulated by Pavlidis and associates
> 

I. Pavlidis, J. Dowdall, N. Sun, C. Puri, J. Fei, and M. Garbey, “Interacting with human physiology,” Comput. Vis. Image Underst. 108(1-2), 150–170 (2007).

- physiological monitoring with thermal camera

> blind source separation (BSS) refers to the recovery of unobserved signals or “sources” from a set of observed mixtures with no prior information about mixing process
> 
- BSS by Independent Component Analysis (ICA)

> ICA is a technique for uncovering the independent source signals from a set of observations that are composed of linear mixtures of the underlying sources
> 

## Setup

- built-in iSight camera on a Macbook Pro by Apple Inc.
- All videos were recorded in color (24-bit RGB with 3 channels × 8 bits/channel) at 15 frames per second (fps) with pixel resolution of 640 × 480 and saved in AVI format on the laptop
- Ground truth
    - FDA approved blood volume pulse (BVP) sensor (Flexcomp Infiniti by Thought Technologies Ltd.)
    - finger probe at 256 Hz
- Indoor ambient
- Varying amount of sunlight as the only source of illumination
- Distrance between the test participant and the webcam of 0,5 m
- 2 videos (1 min each)
    - sitting still
    - moving naturally but not abruptly

## Independent Component Analysis (ICA)

> Volumetric changes in the facial blood vessels during the cardiac cycle modify the path length of the incident ambient light such that the subsequent changes in amount of reflected light indicate the timing of cardiovascular events
> 
- Signals from sensors (R, G and B): $x_1(t)$, $x_2(t)$ and $x_3(t)$
    - amplitudes of the recorded signals (averages of all pixels in the facial region) at time point t
- Recoverable sources
    - $s_1(t)$, $s_2(t)$ and $s_3(t)$
- ICA: observed signals are linear mixtures of the sources

$$
x_i(t) = \sum_{j=1}^{3} a_{ij}s_j(t)
$$

$$
x(t) = As(t)
$$

Objective of ICA:  find a separating or demixing matrix W that is an approximation of the inverse of the original mixing matrix A where  $\hat{s}(t) = Wx(t)$ is an estimate vector of $s(t)$

- W must maximize the nonGaussianity of each source
    - interative methods: kurtosis, negentropy or mutual information

## Pulse measurement methodology

- MATLAB algorithm
1. Face tracker to detect ROI on each video frame
    1. OpenCV to obtain coordinates of face location
    2. Viola and Jones - Rapid object detection using a boosted cascade of simple features (2001)
    3. Lienhart and Maydt - An extended set of Haar-like features for rapid object detection (2002)
2. Separation of RGB channels - average of ROI pixels and normalization
3. Raw normalized RGB traces are decomposed into 3 source signals using ICA
    1. joint approximate diagonalization of eigenmatrices (JADE) algorithm
        1. This approach by tensorial methods uses fourth-order cumulant tensors and involves the joint diagonalization of
        cumulant matrices; the solution of this approximates statistical independence of the sources (to the fourth order)
        2. J.-F. Cardoso, “High-order contrasts for independent component analysis,” Neural Comput. 11(1), 157–192 (1999).
        3. Second component (green) as the desired source signal
4. FFT
    1. Pulse frequency as the highest power of the spectrum 
    2. Operational frequency: 0.75 - 4 Hz / 45 - 240 bpm
5. finger BVP using the same steps

**Noise**

- Historical estimations of pulse frequency to reject artifacts
- Fixed threshold (12 bpm) for maximum change in pulse rate between successive measurements taken every second

### Statistics

- Bland Altman plots - BVP and PPG

## Results

- ICA x Raw signal
    - ICA reduced mean bias and root mean square error (RMSE) and increased correlation coefficient from 0.89 to 0.98.
    - mean bias: 0.9 bpm
    - RMSE: 2.29 bpm
- Motion artifacts
    - Participants free to move the head, talk, laugh
    - Signal of green channel after ICA - weaker than signal at rest and had better SNR
    - mean bias: 0.64 bpm
    - RMSE: 4.63 bpm
    - correlation coef: 0.95

Table 1. Descriptive Statistics of Heart Rate Measurements by Proposed Methodology and Reference BVP

| Statistic                | Sitting still (Before ICA) | Sitting still (After ICA) | With movement artifacts (Before ICA) | With movement artifacts (After ICA) |
|--------------------------|----------------------------|----------------------------|--------------------------------------|-------------------------------------|
| No. of measurement pairs | 372                        | 372                        | 372                                  | 372                                 |
| Mean bias (bpm)          | 0.09                       | -0.05                      | 8.16                                 | 0.64                                |
| Mean absolute bias (bpm) | 2.79                       | 0.91                       | 10.81                                | 2.44                                |
| SD of bias (bpm)         | 6.01                       | 2.29                       | 17.58                                | 4.59                                |
| Upper limit (bpm)        | 11.86                      | 4.44                       | 42.62                                | 9.64                                |
| Lower limit (bpm)        | -11.68                     | -4.55                      | -26.31                               | -8.35                               |
| RMSE                     | 6.00                       | 2.29                       | 19.36                                | 4.63                                |
| Correlation coefficient  | 0.89*                      | 0.98*                      | 0.15‡                                | 0.95*                               |

\*Indicates significance at p < 0.001, ‡Indicates significance at p < 0.005


# Discussion

> It is possible that linearity assumed by ICA is not representative of the true underlying mixture in the signals given that the reflected light intensity varies nonlinearly with distance traveled through the facial tissue according to the Beer-Lambert law.
> 
- Physiological changes in blood volume due to motion are not well understood and could also
be nonlinear

> One possible method of improving performance would be to detrend the RGB signals prior to performing ICA
> 
- Artifacts
    - Movement - only light movement considered
    - Non linearity of changes
    - Face tracking method

> Another area for improvement is in determining which ICA component to choose for spectral analysis. The second component typically, but not always contained the strongest pulse signal. It is unclear why this is the case but one might expect it to be related to the green channel and the fact that hemoglobin absorptivity is highest in green/yellow light. This is consistent with previous reports indicating that green/yellow light (510 – 590 nm) provides
the greatest sensitivity to blood pulsations
>