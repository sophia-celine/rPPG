# Advancements in Noncontact, Multiparameter Physiological Measurements Using a Webcam

*M. -Z. Poh, D. J. McDuff and R. W. Picard, "Advancements in Noncontact, Multiparameter Physiological Measurements Using a Webcam," in IEEE Transactions on Biomedical Engineering, vol. 58, no. 1, pp. 7-11, Jan. 2011, doi: 10.1109/TBME.2010.2086456*

- ICA to extract BVP as source signal

# Methods

- 12 participants (4 females 8 males)
- built in webcam (iSight camera)
- Distance of 0.5 m to the laptop
- 1 min recording
- All videos were recorded in color (24-bit RGB with three channels × 8 bits/channel) at 15 frames per second (fps) with pixel resolution of 640 × 480 and saved in AVI format on
the laptop.
- BVP ground truth: finger FDA approved BVP
- Respiration rate ground truth: respiration sensor Flexcomp Infiniti by Thought Technologies
Ltd., respectively at a sampling rate of 256 Hz
- MATLAB

1. OpenCV Boosted cascade classifier to identify the coordinates of face location
    1. center 60% width and full height of the box as the region of interest
2. Separation of RGB channels and spatial average of pixels in the ROI
3. Detrend of raw traces with smoothness priors approach
    1. smoothing parameter $\lambda = 10$
    2. cutoff frequency of 0.89 Hz
    3. M. P. Tarvainen, P. O. Ranta-Aho, and P. A. Karjalainen, “An advanced detrending method with application to HRV analysis,” IEEE Trans. Biomed. Eng., vol. 49, no. 2, pp. 172–175, Feb. 2002.
4. ICA to extrac independent source signals
    1. signal with highest peak was selected for analysis
5. Smoothing of the signal
    1. five-point moving average filter
    2. bandpass filter (128-point Hamming window, 0.7 - 4 Hz)
6. Refine BVP peak fiducial point
    1. interpolation of the signal with cubic spline function at 256 Hz sampling frequency
7. Algorithm to detect BVP peaks
    1. obtain interbeat intervals (IBI)
    2. Avoid artifacts: filter IBIs with noncausal of variable threshold (NC-VT)
        1. J. Vila, F. Palacios, J. Presedo, M. Fernandez-Delgado, P. Felix, and S. Barro, “Time-frequency analysis of heart-rate variability,” IEEE Eng. Med. Biol. Mag., vol. 1 6, no. 5, pp. 119–126, Sep./Oct. 1997.
            
            ```jsx
            for i = 2 to N-1
            if ( abs(HR(i) - HR(L)) / HR(L) < u_u OR
            abs(HR(i) - HR(i+1)) / HR(L) < u_u OR
            abs(HR(i) - M) / M < u_m )
            accept HR(i)
            every STEP iterations
            update u_u, u_m
            else
            i = i + 1
            ```
            
            N represents the number of elements of the HR series.
            L is the index of the last accepted value.
            M is the mean of the last *STEP* values.
            uₙ and uₘ depend on deviation of the last `STEP` HR values.
            
        2. tolerance of 30%
8. HR was calculated from the mean of the IBI time series as 60/IBI
9. Analysis of HRV was performed by power spectral density (PSD) estimation using the Lomb periodogram
    1. Low frequency (LF) and hgh frequency (HF) measured as the area under the PDS curve corresponding to 0.04–0.15 and 0.15–0.4 Hz, respectively
    2. LF component is modulated by baroreflex activity and includes both sympathetic and parasympathetic influences
    3. HF component reflects parasympathetic influence on the heart through efferent vagal activity and is connected to respiratory sinus arrhythmia (RSA)
10. Since the HF component is connected with breathing, the RR can be estimated from the HRV power spectrum
    1. When the frequency of respiration changes, the center frequency of the HF peak shifts in accordance with RR
        1. $RR = \frac{60}{f_{HFpeak}}$

## Results

- BVP from webcam and groundtruth are comparable
- IBIs signals are also comparable
- IBI series has is irregularly time-sampled
    - PSD from Lomb periodogram
- RR obtained from the HRV power spectrum as the center frequency of the HF peak
- Metric: Pearson’s correlation coefficients (n = 12) - correlation coef
    - HR: r=1
    - HF and LF: r=0.92
    - LF/HF: r=0.88
    - RR: 0.94
- RMSE
    - HR: 1.24 bpm
    - HF: 12.3
    - LF: 12.3
    - LF/HF: 1.1
    - RR: 1.28

## Results

| Statistic | Heart Rate (bpm) | Respiratory Rate (breaths/min) | Heart Rate Variability LF (n.u.) | HF (n.u.) | LF/HF |
| --- | --- | --- | --- | --- | --- |
| Mean error | 0.95 | 0.12 | 7.53 | 7.53 | 0.57 |
| SD of error | 0.83 | 1.33 | 10.17 | 10.17 | 0.98 |
| RMSE | 1.24 | 1.28 | 12.3 | 12.3 | 1.1 |
| Correlation coefficient | 1.00 | 0.94 | 0.92 | 0.92 | 0.88 |
- timestap of each video frame would boost performance and would avoid misalignments of the BVP signal compared to the reference signal
- Video rate of 30 fps is much lower than the recommended for HRV analysis (>250 Hz)
    - interpolation at 256 Hz
- PPG beat-to-beat variability can be affected by changes in the pulse transit time, which is related to arterial
compliance and blood pressure
    - **Pulse transit time** (PTT) is the duration it takes for an arterial pulse wave to travel between two points in the arterial system