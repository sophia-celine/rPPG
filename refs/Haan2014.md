# Improved motion robustness of remote-PPG by using the blood volume pulse signature

De Haan, G.; Jeanne, V. Improved motion robustness of remote-PPG by using the blood volume pulse signature. Physiol. Meas. 2014, 35, 1913–1926

## Analysis and methods

Analysis of the pulse-signal in RGB-space

- The resulting relative PPG-amplitude, as a function of the wavelength λ, of the signal from the PPG sensor,  $RPPG (λ) = σ (PPG (λ))/μ (PPG (λ))$, is determined by the contrast between the blood and the blood-free tissue (Hülsbusch)
    - simulation considering 3% melanin concentration and considering the absorbtion spectrum of the dermis and the epidermis showed absorption peaks of oxygenated blood at λ = 542 nm and λ = 577 nm can be clearly recognized
- Measured σ (PPG (λ)) using a spectrometer analyzing the light reflected from a skin-region illuminated by a tungsten-halogen incandescent light source
    - shows a strong amplitude peak around λ = 550 nm
    - definition of a derived relative PPG using the emission spectrum of a tungsten-halogen incandescent lamp
    - Relation of the absolute PPG and the relative PPG considering the continuous emission spectrum of the tungsten-halogen illumination $I_h(\lambda)$ and the skin reflection $\rho_s(\lambda)$
    
    $$
    PPG(\lambda) = \rho_s(\lambda) I_h(\lambda) RPPG(\lambda)
    $$
    
- blood-volume pulse vector $\vec{P_{bv}}$ as the relative PPG-amplitude in the normalized RGB-color channels of the video camera registering a stationary skin-region:

$$
\vec{P}_{bv} = \frac{    [\, \sigma(\vec{R}_n),\, \sigma(\vec{G}_n),\, \sigma(\vec{B}_n) \,]}{    \sqrt{        \sigma^2(\vec{R}_n) + \sigma^2(\vec{G}_n) + \sigma^2(\vec{B}_n)    }}
$$

With:

$$
\vec{R}_n = \frac{1}{\mu(\vec{R})}\vec{R} - 1, \quad\vec{G}_n = \frac{1}{\mu(\vec{G})}\vec{G} - 1, \quad\vec{B}_n = \frac{1}{\mu(\vec{B})}\vec{B} - 1
$$

where $\vec{R}$, $\vec{G}$ and $\vec{B}$ vectors contain the spatial mean of the red, green and blue pixel values of the skin region and $\mu$ is the temporal mean over N frames, considering the filtered vectors (0.5–3.5 Hz).

- Measures with global-shutter CCD camera white-balanced on tungsten-halogen incandescent illumination
    - responses $H_R(\lambda)$, $H_G(\lambda)$ and $H_G(\lambda)$ of the RGB color-channels
    - measures of skin reflectance
    - predicted blood volume pulse vector using Hülsbusch’s spectrum:
    
    $$
    \vec{P}_{bv} =
    \left[
    \tfrac{
    \int_{400}^{700} H_R(\lambda)\, \tfrac{I(\lambda)}{I_h(\lambda)}\, PPG(\lambda)\, d\lambda
    }{
    \int_{400}^{700} H_R(\lambda)\, \tfrac{I(\lambda)}{I_h(\lambda)}\, \rho_s(\lambda)\, d\lambda
    },
    \;
    \tfrac{
    \int_{400}^{700} H_G(\lambda)\, \tfrac{I(\lambda)}{I_h(\lambda)}\, PPG(\lambda)\, d\lambda
    }{
    \int_{400}^{700} H_G(\lambda)\, \tfrac{I(\lambda)}{I_h(\lambda)}\, \rho_s(\lambda)\, d\lambda
    },
    \;
    \tfrac{
    \int_{400}^{700} H_B(\lambda)\, \tfrac{I(\lambda)}{I_h(\lambda)}\, PPG(\lambda)\, d\lambda
    }{
    \int_{400}^{700} H_B(\lambda)\, \tfrac{I(\lambda)}{I_h(\lambda)}\, \rho_s(\lambda)\, d\lambda
    }
    \right]
    $$
    
- the pulse-signal observed in all camera color channels largely originates from wavelengths between 500 nm and 600 nm
- the blood volume pulse vector depends on the optical filters of the camera, the illumination spectrum and the skin-reflectance
- The relative reflectance of the skin in the RGB-channels under white illumination is stable through the complete range of skin-pigmentation
    - the absorption spectra of the blood-free skin is dominated by the melanin absorption
    - a higher melanin concentration can increase the absolute absorption, but the relative absorption in the different wavelengths remains the same
- melanin index of subjects measured using a skin pigmentation analyzer SPA 99, from Courage and Khazaka

### New methods

> The stable Pbv can be used as the ‘signature’ of blood volume change to distinguish their color variations from those due to alternative causes.
> 
- Assumption
    - the pulse-signal can be built as a linear combination of normalized color signals
- The relative amplitudes of the rgb color channels are given by Pbv
- Find the weights which give a pulse signal S for which the correlation with the color channels equals Pbv
    - $\vec{S}\, \mathbf{C}_n^{T} = k \vec{P}_{bv}\;\Leftrightarrow\;\vec{W}_{PBV} \mathbf{C}_n \mathbf{C}_n^{T} = k \vec{P}_{bv}$
    - $\vec{W}_{PBV} = k \vec{P}_{bv} \mathbf{Q}^{-1}\quad \text{with} \quad\mathbf{Q} = \mathbf{C}_n \mathbf{C}_n^{T}$
    - scalar $k$ chosen so that the weights vector $\vec{W}_{PBV}$ has unit length
- Use PBV in addition to BSS methods with overlapped signal windowing
    - given that BSS methods return 3 component signals, the pulse-signal is selected using a reference weight vector (weights from the chrominance based method ofr from PVB)
- finger oximeter as reference signal (Contec Medical Systems, model CMS50E, or Polar H3 heart-rate sensor for fitness)
- pre processing
    - Butterworth (order 6) band-pass filter with cutoff frequencies 0.5 - 3.5 Hz
- The rate was measured every frame using a peak-detector in the frequency domain using a sliding Fourier window of only 256 frames

## Results and discussion

|  | CHRO | PBV | ICA(CHRO) | ICA(PBV)₎ | PCA(CHRO) | PCA₍(PBV) |
| --- | --- | --- | --- | --- | --- | --- |
| 512: | 8.4 | 7.6 | 6.2 | 5.3 | 4.3 | 3.6 |
| 64: | 8.2 | 5.6 | 3.1 | 1.0 | 1.8 | 0.1 |

> We assume that with fewer distortions the reference weight vector may become poorly defined, which leads to this drop in signal quality for simple stationary cases
>